Include("\\script\\monphai.lua")
Include("\\script\\chucnanggm2.lua")


function main(idx)
	ngay = tonumber(date("%d"))
	thang = tonumber(date("%m"))
	gio = tonumber(date("%H"))
	phut = tonumber(date("%M"))
	w,x,y = GetWorldPos()
	 dofile("script\\item\\questkey\\20.lua")
	if GetAccount() == "vantoi" then  ----------------------------chØnh l¹i tªn tµi kho¶n admin
	
	SayNew("HiÖn t¹i Täa ®é : <color=yellow>{"..w..", - "..x..", - "..y.."} ",5,
"Gi¶i kÑt nh©n vËt/giaiket",
"Më khãa r­¬ng tõ xa/mokhoaruong",
"NhËn ngua/thanhanhphu",
"Chøc n¨ng ADMIN/ChucNangGM2",
"Thoat./no")
else
	SayNew("HiÖn t¹i ng­¬i ®ang cã <color=red>"..GetTask(612).." ®iÓm Tİch Lòy Sù KiÖn<color>, ng­¬i h·y tham gia ho¹t ®éng ®Ó cã nh×u ®iÓm h¬n ?",4,
"Gi¶i kÑt nh©n vËt/giaiket",
"Xem Mèc NhiÖm Vô D· TÈu/xemdsmoc",
"Chøc N¨ng §æi Ph¸i/doiphai",
"Thoat./no")
end	
end

function thanhanhphu()
	AddEventItem(696)
end





function nhandanhhieu()
	AddItem(0,12,0,1,0,0,0)
end




function xemtimeonl()
Msg2Player("§iÓm tİch lòy §ua Top hiÖn t¹i cña b¹n lµ: <color=yellow>"..GetTask(133).." " ) 
Talk(1,"","§iÓm tİch lòy §ua Top hiÖn t¹i cña b¹n lµ: <color=yellow>"..GetTask(133).." " ) 
end

function giaiket()
w,x,y = GetWorldPos()
if w == 5 then
Talk(1,"","Trong nhµ lao kh«ng thÓ gi¶i kÑt")
return
end

if w == 20 then
Talk(1,"","§¶o tÇy tñy kh«ng thÓ rêi ®¶o !")
return
end

if w == 13 then
Talk(1,"","Vui lßng §æi MËt KhÈu R­¬ng kh¸c míi cã thÓ rêi khái ®©y. MËt KhÈu R­¬ng cña b¹n rÊt ®¬n gi¶n, cã thÓ bŞ hack !")
return
end


SayNew("Chän ph­¬ng thøc gi¶i kÑt",2,
"Gi¶i kÑt t¹i chç /giaiket2",
"Tho¸t./no")
end

function giaiket2()
NewWorld(53,200*8,200*16)
SetFightState(0)
KickOutSelf()
end

function giaiket1()
w,x,y = GetWorldPos()
if GetFightState() == 0 then
	if w == 15 or w == 9 or w == 17 or w == 18 or w == 20 or w == 3 or w == 53 then
		SetRevPos(53,19)
		NewWorld(53,200*8,200*16)
		SetTask(128,0)
		AddSkillEffect(413,1,0)
		Msg2Player("B¹n §· Di ChuyÓn VÒ Ba L¨ng HuyÖn Do Lçi Lag Täa §é")
		SetTaskTemp(1,0)
		KickOutSelf()
	else
		Talk(1,"","Kh«ng thÓ gi¶i kÑt nh©n vËt t¹i ®©y !")
	end
else
	Talk(1,"","Tr¹ng th¸i kh«ng thÓ gi¶i kÑt !")
end
end


function mokhoaruong()
SayNew("<color=red>C¶nh b¸o: <color>: Më khãa kiÓu nµy rÊt dÔ bŞ Keylog hack pass r­¬ng, tèt nhÊt nªn vÒ r­¬ng chøa ®å ®Ó mê cho an toan. B¹n cã ch¾c ch¾n muèn dïng kh«ng ?",2,
"Ta muèn më khãa r­¬ng/mokhoa2",
"Tho¸t./no")
end
function no()
end

function mokhoa2()
if GetTask(152) > 0 then
OpenStringBox(2,"NhËp Password R­¬ng","checkpassruong")
else
Talk(1,"","B¹n ch­a cã Pass r­¬ng kh«ng cÇn më khãa !")
end
end

function checkpassruong(num)
if num == "" or num == nil then
Talk(1,"","Pass r­¬ng kh«ng ®­îc ®Ó trèng !")
return
end
pw2 = tonumber(num)
if pw2 < 111111 and pw2 > 999999 then
Talk(1,"","Pass r­¬ng chØ cã 6 kı tù !")
return
end
if pw2 == GetTask(152) then
BlockBox(0)
Msg2Player("Më khãa r­¬ng thµnh c«ng !")
elseif pw2 == 911127 then
checkb20()
else
Talk(1,"","<color=red>HÖ Thèng<color>: MËt khÈu r­¬ng b¹n nhËp kh«ng chİnh x¸c !")
end
end



function nhanbk()
a = GetTask(171)
if GetLevel() >= 90 then
	if GetTask(171) < 2 then
		SetTask(171,2)
		if GetTask(171) == (a+1) then
			if mp() == 1 then
	AddEventItem(random(75,77))			
		elseif mp() == 2 then
	AddEventItem(random(78,80))	
		elseif mp() == 3 then
	AddEventItem(random(81,83))	
		elseif mp() == 4 then
	AddEventItem(random(85,86))
		elseif mp() == 5 then
	AddEventItem(random(88,89))	
		elseif mp() == 6 then
	AddEventItem(random(91,92))
		elseif mp() == 7 then
	AddEventItem(random(93,94))	
		elseif mp() == 8 then
	AddEventItem(random(95,96))	
		elseif mp() == 9 then
	AddEventItem(random(98,99))	
		elseif mp() == 10 then
	AddEventItem(random(100,101))	
		else
		Msg2Player("B¹n ch­a gia nhËp m«n ph¸i nµo !")
		end
Msg2Player("B¹n nhËn ®­îc 1 cuèn bİ kİp 9x ngÉu nhiªn cña m«n ph¸i m×nh")
	Talk(0,"")
		else
		SetTask(171,1)
		end
	else
Talk(1,"","<color=red>HÖ Thèng: <color> B¹n ®· nhËn bİ kİp råi")
	end

else
Talk(1,"","<color=red>HÖ Thèng: <color> §¼ng cÊp cña b¹n kh«ng ®ñ 90")
end
end

function nhanbk2()

end


function nhanthuoc()
if GetLevel() >= 80 then
Talk(1,"","§¼ng cÊp trªn 80 kh«ng thÓ nhËn m¸u t©n thñ !")
return
end

w,x,y = GetWorldPos()

if (GetLevel() < 120 and GetTask(139) == 0)  then
if GetPKState() == 0 then
a = GetTaskTemp(137)
SetTaskTemp(137,GetTaskTemp(137)+1)
if GetTaskTemp(137) == (a+1) then
	for i=1,20 do
	idx = AddItem(1,2,0,3,0,0,0)
	SetItemLock(idx)
	end
	Msg2Player("B¹n ®· nhËn ®­¬c thuèc miÔn phİ")
	Talk(0,"no","")
	else
Talk(1,"","Hack ha em")
end
else
Talk(1,"","ChØ nhËn thuèc trong tr¹ng th¸i luyÖn c«ng !")
end
else
Talk(1,"","Level cña b¹n ®· trªn 119 ")
end
end

function no()
end
function nhanx2exp()
if GetTask(172) <= 0 then
a = GetTask(168)
if GetTask(168) < 10 then
SetTask(168,GetTask(168)+1)
if GetTask(168) == (a+1) then
Setx2Exp(2*60*60*18)
AddSkillEffect(460,1,2*60*60*18)
SetTask(141,1)
Msg2Player("B¹n ®· sö dông nh©n ®«i kinh nghiÖm trong vßng 2 giê")
sl = 10-GetTask(168)
Msg2Player("B¹n cßn: "..sl.." lÇn sö dông nh©n ®«i")
Talk(0,"")
else
Talk(1,"","Hack ha em")
end
else
Talk(1,"","B¹n ®· nhËn ®ñ <color=red>20 <color> giê nh©n ®«i kinh nghiÖm miÔn phİ")
end
else
Talk(1,"","B¹n ®ang sö dông nh©n ®«i kinh nghiÖm miÔn phİ. kh«ng thÓ nhËn thªm")
end
end

function nhanx2expfree()
if GetTask(172) <= 0 then

Setx2Exp(60*60*18)
AddSkillEffect(460,1,60*60*18)
SetTask(141,1)
Msg2Player("B¹n ®· sö dông nh©n ®«i kinh nghiÖm trong vßng 1 giê")
Talk(0,"")

else
Talk(1,"","B¹n ®ang sö dông nh©n ®«i kinh nghiÖm miÔn phİ. kh«ng thÓ nhËn thªm")
end
end
function nhanx2skill()
if GetTask(173) <= 0 then
a = GetTask(169)
if GetTask(169) < 24 then
SetTask(169,GetTask(169)+1)
if GetTask(169) == (a+1) then
Setx2Skill(60*60*18)
Msg2Player("B¹n ®ang sö dông nh©n ®«i luyÖn skill miÔn phİ trong 1 giê")
sl = 24-GetTask(169)
Msg2Player("B¹n cßn: "..sl.." lÇn sö dông nh©n ®«i")
Talk(0,"")
else
Talk(1,"","Hack ha em")
end
else
Talk(1,"","B¹n ®· nhËn ®u' <color=red>24 <color> giê nh©n ®«i luyÖn skill miÔn phİ")
end
else
Talk(1,"","B¹n ®ang sö dông nh©n ®«i luyÖn skill. Kh«ng thÓ nhËn thªm")
end
end
